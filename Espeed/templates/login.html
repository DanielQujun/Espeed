<!-- 基础空白文档 -->
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <title>注册</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=no">
    <script type="text/javascript" src="../static/lib/index.min.js"></script>          <!-- 解决移动端适配 -->
    <link rel="stylesheet" href="../static/css/weui.css">
    <link rel="stylesheet" href="../static/css/jquery-weui.css">
    <link rel="stylesheet" href="../static/css/style.css">
    <style>
        /* 部分冲突样式修正 */
        .weui-dialog__hd {
            padding: 0;
        }

        .weui-dialog__bd {
            max-height: 300px;
            overflow-y: scroll;
        }
    </style>
</head>

<body>
<div class="login">
    <!-- 主体内容 -->
    <section class="main">
        <h1>e我速工</h1>
        <form action="/register/" method="post">
            <div class="registerBox">
                <h4>Hi,欢迎登陆</h4>
                <div class="phoneBox">
                    <input id="phoneNum" type="tel" name="phonemun" value="15080755770" placeholder="请输入手机号码">
                </div>
                <div class="codeBox">
                    <input id="signCode" type="number" name="verifycode" value="15080755770" placeholder="请输入验证码">
                    <input id="openid" type="hidden" value="{{ openid }}" name="openid">
                    <!-- <input type="button" value="获取验证码"> -->
                    <a href="javascript:;" class="weui-btn weui-btn_primary weui-btn_mini codeBtn msgs">获取验证码</a>
                </div>
            </div>

            <div class="submitBox">
                <button type="submit" id="loginBtn" class="weui-btn weui-btn_primary">登录</button>
                <p class="tips">未注册的手机号登录时将自动注册且<br/>代表您已同意
                    <a id="policy" href="javascript:;">用户协议</a>
                </p>
            </div>

        </form>
    </section>
</div>

<script type="text/javascript" src="../static/lib/jquery-2.1.4.js"></script>
<script type="text/javascript" src="../static/lib/jquerySession.js"></script>
<script type="text/javascript" src="../static/js/jquery-weui.min.js"></script>        <!-- 为将来做拓展，引入Jquery weui -->
<script type="text/javascript" src="../static/lib/fastclick.js"></script>            <!-- 解决点击屏幕延迟，需要测试是否有效，无效再删除 -->
<script>

    $(function () {
        // 开启fastclick功能
        FastClick.attach(document.body);

        $('#policy').click(function () {
            var $policyTxt = "用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容";
            $.alert($policyTxt, "用户协议");
        })

        //解析url
        var $openId = parseUrl(location.href)[0].openId
        //将openid写入session
        $.session.set("openid",$openId);

        //提交数据
        var $phoneNum = $('#phoneNum').val();
        var $signCode = $('#signCode').val();

        $('#loginBtn').click(function () {
            $.ajax({
                url: "",
                type: "post",
                data: {
                    "openId": $openId,
                    "phoneNum": $phoneNum,
                    "signCode": $signCode
                },
                success: function () {
                    location.href = "";                 //(todo:跳转地址)
                }
            })
        })



    });


    //解析URL
    function parseUrl(url){
        var result = [];
        var query = url.split("?")[1];
        var queryArr = query.split("&");
        queryArr.forEach(function(item){
            var obj = {};
            var key = item.split("=")[0];
            var value = item.split("=")[1];
            obj[key] = value;
            result.push(obj);
        });
        return result;
    }


    //获取短信验证码
    $(function(){
        var validCode=true;
        $(".msgs").click (function () {
            var time=30;
            var code=$(this);
            if (validCode) {
                validCode=false;
                code.addClass("msgs1");
                var t=setInterval(function () {
                    time--;
                    code.html(time+"秒");
                    if (time==0) {
                        clearInterval(t);
                        code.html("重新获取");
                        validCode=true;
                        code.removeClass("msgs1");
                    }
                },1000)
            }
        })
    })






</script>
</body>

</html>
