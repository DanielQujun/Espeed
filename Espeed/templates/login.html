<!-- 基础空白文档 -->
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <title>注册</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=no">
    <script type="text/javascript" src="../static/lib/index.min.js"></script>          <!-- 解决移动端适配 -->
    <link rel="stylesheet" href="../static/css/weui.css">
    <link rel="stylesheet" href="../static/css/jquery-weui.css">
    <link rel="stylesheet" href="../static/css/style.css">
    <style>
        /* 部分冲突样式修正 */

    </style>
</head>

<body>
<div class="login">
    <!-- 主体内容 -->
    <section class="main">
        <h1>e我速工</h1>
        <form action="/register/" method="post" id="loginForm">
            <div class="registerBox">
                <h4>Hi,欢迎登陆</h4>
                <p id="errorMsg"></p>
                <div class="phoneBox">
                    <input id="phoneNum" type="tel" name="phoneNum" value="" maxlength="12" placeholder="请输入手机号码" >
                </div>
                <div class="codeBox">
                    <input id="signCode" type="number" name="signCode" value="" placeholder="请输入验证码" >
                    <input id="openid" type="hidden" value="{{ openid }}" name="openid">
                    <a href="javascript:;" class="weui-btn weui-btn_primary weui-btn_mini canSend validCodeBtn">获取验证码</a>
                </div>
            </div>
            <p> {{ verify_code_wrong }}</p>
            <div class="submitBox">
                <button type="submit" id="loginBtn" class="weui-btn weui-btn_primary">登录</button>
                <p class="tips">未注册的手机号登录时将自动注册且<br/>代表您已同意
                    <a id="policy" href="javascript:;">用户协议</a>
                </p>
            </div>

        </form>
    </section>
</div>

<script type="text/javascript" src="../static/lib/jquery-2.1.4.js"></script>
<script type="text/javascript" src="../static/lib/jquerySession.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/localization/messages_zh.js"></script>
<script type="text/javascript" src="../static/js/jquery-weui.min.js"></script>        <!-- 为将来做拓展，引入Jquery weui -->
<script type="text/javascript" src="../static/lib/fastclick.js"></script>            <!-- 解决点击屏幕延迟，需要测试是否有效，无效再删除 -->
<script>

    $(function () {
        // 开启fastclick功能
        FastClick.attach(document.body);

        $('#policy').click(function () {
            var $policyTxt = "用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容用户协议内容";
            $.alert($policyTxt, "用户协议");
        })

    });

    $().ready(function() {
        $("#loginForm").validate({
            errorPlacement: function(error, element) {
                $( element )
                    .closest( "form" )
                    .find( "#errorMsg" )
                    .append( error ).delay(2000).slideUp(1000);
            },
            errorElement: "span",
            rules: {
                phoneNum: {
                    required: true
                },
                signCode: {
                    required: true
                }
            },
            messages: {
                phoneNum: {
                    required: "请输入您的手机号",
                    maxlength: "请输入正确的手机号"
                },
                signCode: {
                    required: "请输入验证码",
                    maxlength: "请输入正确的验证码"
                }
            }
        });
    });


    //获取短信验证码
    $(function(){

        $(".validCodeBtn.canSend").click (function () {
            var $port = "/verify_code/";             /*/verify_code/*/
            $.ajax({
                async: true,
                url: $port,
                dataType: "json",
                type: "post",
                data: {
//                  openId: $("#openid").val(),
                    openId: "oT69X1PX1jG6Ojhij3tQVOGSnWzQ",
                    phoneNum:$("#phoneNum").val()
                },
                success: function (res) {
                    console.log(res);
                   alert(res);
                },
                error: function(error) {
                    console.log(error.readyState, error.statusText);
                }
            });
            /*var validCode=true;
            var time=60;
            var code=$(this);
            $port = "";
            console.log($port);
            if (validCode) {
                validCode=false;
                code.removeClass('canSend');
                code.addClass("weui-btn_disabled");
                var t=setInterval(function () {
                    time--;

                    code.html(time+"秒后重新获取");
                    if (time==0) {
                        clearInterval(t);
                        code.html("重新获取");
                        validCode=true;
                        code.addClass("canSend");
                        code.removeClass("weui-btn_disabled");
                        $port = "workerList.json";
                    }
                },1000)
            }*/
        })
    })
</script>
</body>

</html>
